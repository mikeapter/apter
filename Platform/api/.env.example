# Platform/api environment variables (copy to .env)
#
# NOTE: This is a TRADING TOOL (signals-only). No auto execution.

# ------------------------------------------------------------
# Environment (development | production)
# ------------------------------------------------------------
ENV=development

# ------------------------------------------------------------
# Security — JWT & Auth
# ------------------------------------------------------------
SECRET_KEY=                          # REQUIRED: long random string (e.g. openssl rand -hex 64)
FERNET_KEY=                          # REQUIRED: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
JWT_ISSUER=apterfinancial
JWT_AUDIENCE=apterfinancial-web
ACCESS_TOKEN_MINUTES=10              # Short-lived access tokens (default 10)
REFRESH_TOKEN_DAYS=14                # Refresh token lifetime (default 14)

# ------------------------------------------------------------
# Security — Rate Limiting (requests per minute)
# ------------------------------------------------------------
RATE_LIMIT_LOGIN=5
RATE_LIMIT_REFRESH=10
RATE_LIMIT_REGISTER=3
RATE_LIMIT_FORGOT_PASSWORD=3

# ------------------------------------------------------------
# Security — Password Reset
# ------------------------------------------------------------
PASSWORD_RESET_TOKEN_MINUTES=15       # Reset token lifetime (default 15)

# ------------------------------------------------------------
# Security — Brute Force Lockout
# ------------------------------------------------------------
LOCKOUT_THRESHOLD=5                  # Failures before lockout
LOCKOUT_DURATION_MINUTES=15          # Lockout duration

# ------------------------------------------------------------
# Security — Request Limits
# ------------------------------------------------------------
MAX_REQUEST_BODY_MB=2

# ------------------------------------------------------------
# Security — Swagger Docs
# ------------------------------------------------------------
# ENABLE_DOCS=false                  # Auto-disabled in production

# ------------------------------------------------------------
# Domain / URLs (used by the web layer + emails)
# ------------------------------------------------------------
PRIMARY_DOMAIN=apterfinancial.com
CANONICAL_URL=https://apterfinancial.com
PUBLIC_BASE_URL=https://apterfinancial.com

# ------------------------------------------------------------
# CORS (comma-separated origins — strict allowlist in production)
# ------------------------------------------------------------
ALLOWED_ORIGINS=https://www.apterfinancial.com,https://apterfinancial.com,https://app.apterfinancial.com

# ------------------------------------------------------------
# HubSpot CRM integration
# ------------------------------------------------------------
# Private app token from HubSpot > Settings > Integrations > Private Apps
# Required scopes: crm.objects.contacts.read, crm.objects.contacts.write
# Leave blank to skip HubSpot sync (safe for local dev)
HUBSPOT_PRIVATE_APP_TOKEN=

# ------------------------------------------------------------
# Local development helpers
# ------------------------------------------------------------
# Used ONLY for local testing endpoints (e.g., dev plan switching)
LOCAL_DEV_API_KEY=

# ------------------------------------------------------------
# Stripe (subscription payments)
# ------------------------------------------------------------
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_SIGNALS=
STRIPE_PRICE_PRO=

# ------------------------------------------------------------
# Finnhub market data (real-time quotes & OHLCV candles)
# ------------------------------------------------------------
# Get a free key at https://finnhub.io/register
# Leave blank to disable Finnhub integration (endpoints return 503)
FINNHUB_API_KEY=
# Optional cache TTL overrides (seconds)
# CACHE_TTL_QUOTE_SECONDS=20
# CACHE_TTL_CANDLES_SECONDS=120

# ------------------------------------------------------------
# SendGrid (transactional email — password resets)
# ------------------------------------------------------------
# Get a key at https://app.sendgrid.com/settings/api_keys
# Leave blank to skip email sending (reset URLs logged instead)
SENDGRID_API_KEY=
FROM_EMAIL=no-reply@apterfinancial.com
FROM_NAME=Apter Financial

# ------------------------------------------------------------
# Market Data / Intelligence Brief
# ------------------------------------------------------------
MARKET_CACHE_TTL_SECONDS=300
# Optional: RapidAPI Yahoo Finance (more stable for production)
# YF_RAPIDAPI_KEY=
# YF_RAPIDAPI_HOST=apidojo-yahoo-finance-v1.p.rapidapi.com
USER_AGENT=ApterFinancial/1.0 (+https://apterfinancial.com)

# ------------------------------------------------------------
# Apter Intelligence (LLM-powered chat)
# ------------------------------------------------------------
# Uses OpenAI-compatible API. Falls back to AI_API_KEY / AI_BASE_URL if not set.
APTER_INTELLIGENCE_API_KEY=
APTER_INTELLIGENCE_BASE_URL=https://api.openai.com/v1
APTER_INTELLIGENCE_MODEL=gpt-4o-mini
# Live data providers (checked in priority order: Finnhub → Polygon → FMP)
FINNHUB_API_KEY=
POLYGON_API_KEY=
FMP_API_KEY=

# ------------------------------------------------------------
# Database (defaults to SQLite for local dev)
# ------------------------------------------------------------
# DATABASE_URL=postgresql://user:pass@host:5432/dbname

# ------------------------------------------------------------
# Redis (optional — enables shared rate limiting, lockout, token store)
# ------------------------------------------------------------
# Without Redis, security stores use in-memory (single-worker only).
# On Render: add a Redis add-on and set REDIS_URL automatically.
# REDIS_URL=redis://localhost:6379/0

# ------------------------------------------------------------
# Apter Intelligence (AI provider configuration)
# ------------------------------------------------------------
AI_PROVIDER=openai_compatible
AI_API_KEY=
AI_MODEL=gpt-4o-mini
AI_BASE_URL=https://api.openai.com/v1
AI_ENABLE_STREAMING=true
AI_CACHE_TTL_SECONDS=300
AI_TIMEOUT_SECONDS=60
